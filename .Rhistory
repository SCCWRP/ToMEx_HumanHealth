rename(Type="shape")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Shape")%>%
mutate(Type = case_when(
Type == "fragment" ~ "Fragment",
Type == "sphere" ~ "Sphere",
Type == "NA" ~ "Not Reported"))
study_sh<-xtabs(~shape + effect,aoc)
shapefinal<- data.frame(cbind(shapef, study_sh))%>%
rename(Endpoints='Freq.1')%>%
rename(category='shape')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
lvl1df<-rowPerc(xtabs(~lvl1 +effect, aoc))
lvl1f<-as.data.frame(lvl1df)%>%
filter(effect %in% c("Y","N"))%>%
rename(Type= "lvl1")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Lvl1")%>%
mutate(Type = case_when(
Type == "alimentary.excretory" ~ "Alimentary, Excretory",
Type == "behavior.sense.neuro" ~ "Behavioral, Sensory, Neurological",
Type == "cell.growth.proliferation" ~ "Cell Growth and Proliferation",
Type == "cell.morphology.structure" ~ "Cell Morphology and Structure",
Type == "circulatory" ~ "Circulatory",
Type == "cytotoxicity" ~ "Cytotoxicity",
Type == "endocrine.signaling" ~ "Endocrine Signaling",
Type == "fitness" ~ "Fitness",
Type == "immune" ~ "Immune",
Type == "metabolism" ~ "Metabolism",
Type == "microbiome" ~ "Microbiome",
Type == "respiratory" ~ "Respiratory",
Type == "stress" ~ "Stress"))
study_l<-xtabs(~lvl1 +effect,aoc)
lvl1final<- data.frame(cbind(lvl1f, study_l))%>%
rename(Endpoints='Freq.1')%>%
rename(category='lvl1')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
lifedf<-rowPerc(xtabs(~life.stage +effect, aoc))
lifef<-as.data.frame(lifedf)%>%
filter(effect %in% c("Y","N"))%>%
rename(Type= "life.stage")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Life.stage")%>%
mutate(Type = case_when(
Type == "early,f1"~"Early, F1 Generation",
Type == "early,f2"~"Early, F2 Generation",
Type == "juvenile"~"Juvenile",
Type == "adult"~"Adult",
Type == "Not Reported"~"Not Reported"))
studyli<-xtabs(~life.stage +effect ,aoc)
lifefinal<- data.frame(cbind(lifef, studyli))%>%
rename(Endpoints='Freq.1')%>%
rename(category='life.stage')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
#in vitro/in vivo by measurement and type
vivodf<-rowPerc(xtabs(~invitro.invivo +effect, aoc))
vivof<-as.data.frame(vivodf)%>%
filter(effect %in% c("Y","N"))%>%
rename(Type= "invitro.invivo")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Invivo.invivo")%>%
mutate(Type = case_when(
Type=="invivo"~"In Vivo",
Type=="invitro"~"In Vitro"))
study_v<-xtabs(~invitro.invivo +effect,aoc)
vivofinal<- data.frame(cbind(vivof, study_v))%>%
rename(Endpoints='Freq.1')%>%
rename(category='invitro.invivo')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
#in vitro/in vivo by study and type
vivoFinal_type_study<-aoc %>%
group_by(invitro.invivo, effect) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(Type= "invitro.invivo")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Invivo.invivo")%>%
mutate(Type = case_when(
Type=="invivo"~"In Vivo",
Type=="invitro"~"In Vitro")) %>%
rename(Studies='studyCount')%>%
mutate(logStudies = log(Studies))%>%
rename(Percent = freq)#renames column
#in vitro/in vivo by year and measurement
vivodf_year_measurement<-rowPerc(xtabs(~invitro.invivo +year, aoc)) %>%
as.data.frame()%>%
filter(year!="Total") %>% #supress Total column to be able to cbind later
rename(Type= "invitro.invivo")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Invivo.invivo")%>%
mutate(Type = case_when(
Type=="invivo"~"In Vivo",
Type=="invitro"~"In Vitro"))
study_v_year<-as.data.frame(xtabs(~invitro.invivo +year, aoc))
vivoFinal_year<- data.frame(cbind(vivodf_year_measurement, study_v_year))%>%
rename(Endpoints='Freq.1')%>%
rename(category='invitro.invivo')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
#in vitro/in vivo by year and study
vivoFinal_year_study<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(Type= "invitro.invivo")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Invivo.invivo")%>%
mutate(Type = case_when(
Type=="invivo"~"In Vivo",
Type=="invitro"~"In Vitro")) %>%
rename(Studies='studyCount')%>%
mutate(logStudies = log(Studies))%>%
rename(Percent = freq)#renames column
routedf<-rowPerc(xtabs(~exposure.category +effect, aoc))
routef<-as.data.frame(routedf)%>%
filter(effect %in% c("Y","N"))%>%
rename(Type= "exposure.category")%>%
mutate_if(is.numeric, round,0)%>%
mutate(plot="Exposure.category")%>%
mutate(Type = case_when(
Type == "Dermal" ~ "Dermal",
Type == "Ingestion" ~ "Ingestion",
Type == "Inhalation" ~ "Inhalation",
Type == "IV Injection" ~ "IV Injection",
Type == "In Vitro" ~ "In Vitro"))
#Type == "inhalation" ~ "Inhalation",
#Type == "intratracheal.instillation" ~ "Intratracheal Instillation",
#Type == "iv.injection" ~ "IV Injection",
#Type == "drinking.water" ~ "Drinking Water",
#Type ==  "Not Applicable"~"Not Applicable"))
study_r<-xtabs(~exposure.category +effect,aoc)
routefinal<- data.frame(cbind(routef, study_r))%>%
rename(Endpoints='Freq.1')%>%
rename(category='exposure.category')%>%
mutate(logEndpoints = log(Endpoints))%>%
rename(Percent = Freq)#renames column
view(vivoFinal_year)
view(vivoFinal_year_study)
test<-vivoFinal_year_study%>%
filter(Studies)
test<-vivoFinal_year_study%>%
filter(Studies > 0)
test
test<-vivoFinal_year_study%>%
select(Studies > 0)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()
test
test
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
pull(Type, Year, studies)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
pull(studies)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()
test
runApp()
runApp()
view(study_r)
view(study_v)
study_v%>%
mutate(Effect = 'effect')%>%
mutate("Invitro or Invivo" = 'invitro.invivo')
study_v%>%
mutate(Effect = 'effect')%>%
mutate(Invitro  = 'invitro.invivo')
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(Type, year, Studies)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(invitro.invivo, year, Studies)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(invitro.invivo, year, studyCount)
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(invitro.invivo, year, studyCount)%>%
mutate(studies = 'studyCount')
view(test)
test<-aoc %>%
group_by(invitro.invivo, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(invitro.invivo, year, studyCount)%>%
rename(studies = 'studyCount')
view(test)
view(vivoFinal_year_study)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, studyCount)%>%
rename(Studies = 'studyCount')%>%
rename(Year = 'year')
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, studies)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, Studies)%>%
rename( Year = 'year')
view(table_studies_v)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, Studies)%>%
rename( Year = 'year')%>%
mutate(Studies = mean(studies))
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, Studies)%>%
rename( Year = 'year')%>%
mutate(Studies = mean(Studies))
view(table_studies_v)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, year, Studies)%>%
rename( Year = 'year')
view(table_studies_v)
table_endpoints_v%>%
mutate(Effect = 'effect')%>%
mutate(Invitro  = 'invitro.invivo')
table_endpoints_v<-study_v%>%
mutate(Effect = 'effect')%>%
mutate(Invitro  = 'invitro.invivo')
table_endpoints_v<-study_v%>%
rename(Effect = 'effect')%>%
rename(Invitro  = 'invitro.invivo')
table_endpoints_v<-study_v%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Invitro  = 'invitro.invivo')
view(table_endpoints_v)
view(table_endpoints_v)
table_endpoints_v<-study_v%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Invitro  = 'invitro.invivo')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_v)
runApp()
runApp()
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, Studies)
view(table_studies_v)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, Studies)
view(table_studies_v)
runApp()
test <- table_studies_v %>%
group_by(Type, Studies) %>%
summarise(
AverageS = sum(Studies)
)
view(test)
runApp()
test<-table_studies_v%>%
group_by(Type)%>%
summarise(test1 = sum(Studies))
view(test)
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, Studies)%>%
group_by(Type)%>%
summarise(test1 = sum(Studies))
view(table_studies_v)
runApp()
#vivo/vitro studies
table_studies_v<-vivoFinal_year_study%>%
select(Type, Studies)%>%
group_by(Type)%>%
summarise(Studies = sum(Studies))
view(table_studies_v)
runApp()
runApp()
runApp()
runApp()
table_studies_sh<-aoc %>%
group_by(shape, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()
view(table_studies_sh)
table_studies_sh<-aoc %>%
group_by(shape, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
select(shape, Studies)%>%
group_by(shape)%>%
summarise(Studies = sum(Studies))
table_studies_sh<-aoc %>%
group_by(shape, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(shape, Studies)%>%
group_by(shape)%>%
summarise(Studies = sum(Studies))
table_studies_sh<-aoc %>%
group_by(shape, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(shape, studies)%>%
group_by(shape)%>%
summarise(Studies = sum(Studies))
table_studies_sh<-aoc %>%
group_by(shape, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(shape, studies)%>%
group_by(shape)%>%
summarise(studies = sum(studies))
view(table_studies_sh)
# number of measurements
table_endpoints_sh<-study_v%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Invitro  = 'invitro.invivo')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_sh)
# number of studies
table_studies_si<-aoc %>%
group_by(size, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(size, studies)%>%
group_by(shape)%>%
summarise(studies = sum(studies))
# number of studies
table_studies_si<-aoc %>%
group_by(size.category, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(size.category, studies)%>%
group_by(shape)%>%
summarise(studies = sum(studies))
# number of studies
table_studies_si<-aoc %>%
group_by(size.category, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(size.category, studies)%>%
group_by(size.category)%>%
summarise(studies = sum(studies))
# number of measurements
table_endpoints_sh<-study_v%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( shape  = 'shape')%>%
rename( Endpoints = 'Freq')
# number of measurements
table_endpoints_sh<-study_v%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
#rename( shape  = 'shape')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_sh)
# number of measurements
table_endpoints_sh<-study_sh%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
#rename( shape  = 'shape')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_sh)
# number of measurements
table_endpoints_sh<-study_sh%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Shape  = 'shape')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_sh)
# number of measurements
table_endpoints_si<-study_s%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Size = 'size.category')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_sh)
view(table_endpoints_si)
# number of studies
table_studies_li<-aoc %>%
group_by(life.stage, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(life.stage, studies)%>%
group_by(life.stage.category)%>%
summarise(studies = sum(studies))
# number of studies
table_studies_li<-aoc %>%
group_by(life.stage, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(life.stage, studies)%>%
group_by(life.stage)%>%
summarise(studies = sum(studies))
# number of measurements
table_endpoints_li<-study_li%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Lifestage = 'life.stage')%>%
rename( Endpoints = 'Freq')
# number of measurements
table_endpoints_li<-studyli%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Lifestage = 'life.stage')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_si)
view(table_endpoints_li)
table_studies_li<-aoc %>%
group_by(lvl1, year) %>%
summarize(studyCount = n_distinct(doi)) %>%
mutate(freq = 100 * studyCount / sum(studyCount)) %>%
as.data.frame()%>%
rename(studies = studyCount)%>%
select(lvl1, studies)%>%
group_by(lvl1)%>%
summarise(studies = sum(studies))
# number of measurements
table_endpoints_li<-study_lvl1%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Categories = 'lvl1')%>%
rename( Endpoints = 'Freq')
# number of measurements
table_endpoints_li<-study_l%>%
as.data.frame()%>%
rename( Effect = 'effect')%>%
rename( Categories = 'lvl1')%>%
rename( Endpoints = 'Freq')
view(table_endpoints_li)
runApp()
shiny::runApp()
